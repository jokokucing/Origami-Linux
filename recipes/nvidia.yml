# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: origami-nvidia
description: "Origami is a next-generation Linux distribution inspired by the art of Japanese paper folding. Built on Fedora Atomic, Origami elegantly folds together cutting-edge tools, beautiful design, and thoughtful defaults to create a lightweight, customizable, and visually stunning operating system using the Cosmic desktop environment. With a focus on simplicity, speed, and creativity, Origami empowers users to shape their digital environment as effortlessly as folding a masterpiece. "
base-image: ghcr.io/blue-build/base-images/fedora-cosmic
image-version: latest
#blue-build-tag: main

platforms:
  - linux/amd64

modules:
  - type: files
    files:
      - source: system
        destination: /

  - type: custom-kernel
    source: local
    kernel: cachyos-lto
    nvidia: true
    secrets:
      - type: file
        source: .secure_files/MOK.priv
        mount:
          type: file
          destination: /tmp/certs/MOK.priv
    sign:
      key: /tmp/certs/MOK.priv
      cert: /usr/share/cert/MOK.pem
      mok-password: origami

  - type: dnf
    repos:
      cleanup: true
      copr:
        - bieszczaders/kernel-cachyos-addons
    remove:
      packages:
        - zram-generator-defaults
    install:
      skip-unavailable: true
      packages:
        - cachyos-settings
        - scx-scheds
        - scx-tools

  - type: script
    scripts:
      - adios-ioscheduler.sh

  - from-file: core.yml

  - type: dnf
    install:
      packages:
        - nvtop

  - type: os-release
    properties:
      ID: origami-nvidia
      ID_LIKE: fedora
      NAME: Origami Linux Nvidia
      PRETTY_NAME: Origami 折り紙
      HOME_URL: "https://origami.wf/"
      BUG_REPORT_URL: "https://gitlab.com/groups/origami-linux/-/issues"
      DEFAULT_HOSTNAME: origami

  - type: initramfs

  - type: signing
